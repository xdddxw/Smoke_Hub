(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43],{1872:function(e,t,a){Promise.resolve().then(a.bind(a,2754))},2754:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var s=a(7437),l=a(2265),i=a(9376),n=a(5013),c=a(7633),o=a(6171),r=a(1557),d=a(7648),h=a(4115);let m=[{id:"disposables",name:"Одноразки",image:"/Categoria/Logo2.JPG"},{id:"liquids",name:"Жидкости",image:"/Categoria/Logo1.JPG"},{id:"pods",name:"Поды",image:"/Categoria/Logo4.JPG"},{id:"cartridges",name:"Картриджи",image:"/Categoria/Logo3.JPG"}];function u(){let e=(0,i.useSearchParams)(),[t,a]=(0,l.useState)([]),[u,x]=(0,l.useState)(!1),[g,p]=(0,l.useState)([]),[f,b]=(0,l.useState)(1),[w,j]=(0,l.useState)(1),[v,y]=(0,l.useState)(e.get("cat")||"all"),[N,k]=(0,l.useState)("all"),[S,C]=(0,l.useState)([]),[D,q]=(0,l.useState)(!1),[_,T]=(0,l.useState)({show:!1,message:"",type:"success"}),[E,P]=(0,l.useState)(!1),[F,J]=(0,l.useState)(!1),L="https://kaifsmoke.com";(0,l.useEffect)(()=>{let e="all"===v?null:v;fetch("".concat(L,"/api/brands").concat(e?"?category=".concat(e):"")).then(e=>e.json()).then(e=>C(e)).catch(e=>console.error("Failed to fetch brands:",e))},[L,v]),(0,l.useEffect)(()=>{a((0,h.dv)()),P(!0),"true"===e.get("openCart")&&x(!0);let t=sessionStorage.getItem("catalogState");if(t)try{let e=JSON.parse(t);y(e.category||"all"),k(e.brand||"all"),b(e.page||1),J(!0),sessionStorage.removeItem("catalogState"),setTimeout(()=>{window.scrollTo(0,e.scrollY||0)},100)}catch(e){console.error("Failed to restore catalog state:",e)}},[e]),(0,l.useEffect)(()=>{E&&(0,h.FP)(t)},[t,E]),(0,l.useEffect)(()=>{q(!0);let e="".concat(L,"/api/variations?page=").concat(f);"all"!==v&&(e+="&category=".concat(v)),"all"!==N&&(e+="&brand=".concat(encodeURIComponent(N))),fetch(e).then(e=>e.json()).then(e=>{p((e.items||[]).filter(e=>e.stock>0)),j(e.pages||1)}).catch(e=>console.error("Failed to fetch variations:",e)).finally(()=>q(!1))},[L,v,N,f]);let G=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";T({show:!0,message:e,type:t}),setTimeout(()=>T({show:!1,message:"",type:"success"}),3e3)},I=e=>{let s=e.stock||0,l=t.find(t=>t.id===e.id);((null==l?void 0:l.qty)||0)>=s||(l?a(t.map(t=>t.id===e.id?{...t,qty:t.qty+1}:t)):a([...t,{...e,product_name:e.product_name,category:e.category,qty:1}]),G("Товар добавлен в корзину","success"))},O=t.reduce((e,t)=>e+t.qty,0);return(0,s.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,s.jsx)(n.Z,{cartCount:O,onCartClick:()=>x(!0)}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-12 w-full flex-grow",children:[(0,s.jsx)("h1",{className:"text-4xl md:text-6xl font-black mb-12 text-white tracking-tight animate-slide-up",children:"КАТАЛОГ"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-1 animate-slide-up",style:{animationDelay:"0.1s"},children:(0,s.jsxs)("div",{className:"glass-panel p-6 sticky top-24 rounded-2xl",children:[(0,s.jsx)("h3",{className:"font-black text-lg mb-6 text-white hidden lg:block",children:"\uD83D\uDD0D ФИЛЬТРЫ"}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)("button",{onClick:()=>{y("all"),k("all"),b(1)},className:"col-span-2 px-3 py-2 rounded-lg font-bold transition-all duration-300 text-sm ".concat("all"===v?"bg-purple-600 text-white shadow-lg shadow-purple-500/30":"bg-white/5 text-white/60 hover:bg-white/10 hover:text-white"),children:"Все категории"}),m.map(e=>(0,s.jsx)("button",{onClick:()=>{y(e.id),k("all"),b(1)},className:"relative aspect-square rounded-xl overflow-hidden transition-all duration-300 group ".concat(v===e.id?"ring-2 ring-purple-500 scale-105":"hover:ring-2 hover:ring-purple-500/50"),children:(0,s.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"})},e.id))]})}),S.length>0&&(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[(0,s.jsx)("button",{onClick:()=>{k("all"),b(1)},className:"px-3 py-1.5 rounded-lg font-bold text-xs transition-all duration-300 whitespace-nowrap flex-shrink-0 ".concat("all"===N?"bg-purple-600 text-white":"bg-white/5 text-white/60 hover:bg-white/10 hover:text-white"),children:"Все бренды"}),S.map(e=>(0,s.jsx)("button",{onClick:()=>{k(e.name),b(1)},className:"px-3 py-1.5 rounded-lg font-bold text-xs transition-all duration-300 whitespace-nowrap flex-shrink-0 ".concat(N===e.name?"bg-purple-600 text-white":"bg-white/5 text-white/60 hover:bg-white/10 hover:text-white"),children:e.name},e.id))]})})]})}),(0,s.jsxs)("div",{className:"lg:col-span-3 animate-slide-up",style:{animationDelay:"0.2s"},children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,s.jsxs)("p",{className:"font-bold text-white/60",children:["Страница ",(0,s.jsx)("span",{className:"text-white",children:f})," из ",(0,s.jsx)("span",{className:"text-white",children:w})]})}),D?(0,s.jsx)("div",{className:"glass-panel rounded-2xl p-12 text-center",children:(0,s.jsx)("p",{className:"text-white/60 text-lg",children:"Загрузка..."})}):0===g.length?(0,s.jsx)("div",{className:"glass-panel rounded-2xl p-12 text-center",children:(0,s.jsx)("p",{className:"text-white/60 text-lg",children:"Товары не найдены"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-8",children:g.map((e,t)=>(0,s.jsx)(d.default,{href:"/product/".concat(e.product_id,"?variation=").concat(e.id),onClick:()=>{sessionStorage.setItem("catalogState",JSON.stringify({category:v,brand:N,page:f,scrollY:window.scrollY}))},children:(0,s.jsxs)("div",{className:"glass-panel rounded-2xl p-4 h-full flex flex-col cursor-pointer hover:scale-105 transition-transform duration-300 animate-scale-in",style:{animationDelay:"".concat(.05*t,"s")},children:[(0,s.jsxs)("div",{className:"w-full aspect-square bg-black/40 rounded-xl mb-4 flex items-center justify-center overflow-hidden",children:[(0,s.jsx)("img",{src:"".concat(L,"/api/variations/").concat(e.id,"/image"),alt:e.name,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}}),(0,s.jsx)("span",{className:"text-4xl",style:{display:"none"},children:"\uD83D\uDCA8"})]}),(0,s.jsx)("h3",{className:"font-bold text-white mb-1 text-sm line-clamp-2",children:e.product_name}),(0,s.jsx)("p",{className:"text-xs text-white/60 mb-3",children:e.name}),(0,s.jsxs)("div",{className:"mt-auto",children:[(0,s.jsxs)("p",{className:"text-lg font-black text-white mb-3",children:[e.price.toFixed(2)," zł"]}),(0,s.jsx)("button",{onClick:t=>{t.preventDefault(),I(e),t.currentTarget&&(t.currentTarget.classList.add("animate-bounce"),setTimeout(()=>{t.currentTarget&&t.currentTarget.classList.remove("animate-bounce")},500))},disabled:0===e.stock,className:"w-full bg-gradient-primary text-white py-2 rounded-lg font-bold text-sm hover:opacity-90 transition-all disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",children:"В корзину"})]})]})},e.id))}),(0,s.jsx)("div",{className:"flex justify-center gap-2 mt-8",children:Array.from({length:Math.min(5,w)},(e,t)=>{let a=t+1;return(0,s.jsx)("button",{onClick:()=>b(a),className:"w-10 h-10 rounded-lg font-bold transition-all ".concat(f===a?"bg-purple-600 text-white":"bg-white/10 text-white hover:bg-white/20"),children:a},a)})})]})]})]})]}),(0,s.jsx)(c.Z,{}),u&&(0,s.jsx)(o.Z,{cart:t,onRemove:e=>{a(t.filter(t=>t.id!==e))},onClose:()=>x(!1),onUpdateQty:(e,s)=>{a(t.map(t=>{if(t.id===e){let e=t.qty+s;return e>0?{...t,qty:e}:t}return t}).filter(e=>e.qty>0))},onShowToast:G}),_.show&&(0,s.jsx)("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 px-6 py-3 rounded-full font-bold text-white z-50 animate-slide-up shadow-lg ".concat("success"===_.type?"bg-green-500":"bg-red-500"),children:_.message}),(0,s.jsx)(r.Z,{})]})}function x(){return(0,s.jsx)(l.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center text-white",children:"Загрузка..."}),children:(0,s.jsx)(u,{})})}}},function(e){e.O(0,[448,557,528,971,117,744],function(){return e(e.s=1872)}),_N_E=e.O()}]);